<?xml version="1.1" encoding="UTF-8" standalone="yes"?>
<configuration xmlns="https://cm5.intertrust.ru/config">

    <domain-object-type name="Outgoing_Document" audit-log="true" initial-status="Active"> <!-- OUTGOING_DOCUMENT table -->
        <fields>
            <string name="Registration_Number" length="128" /> <!-- REGISTRATION_NUMBER column -->
            <dateTime name="Registration_Date"/>
            <string name="Name" length="128" />
            <string name="Description" length="128" />
            <reference name="Author" type="Employee"/> <!-- ID of employee in fact -->
            <reference name="Negotiator" type="Employee"/> <!-- This means
             Foreign Key to Employee and index are created automatically -->
            <reference name="Signer" type="Employee"/>
            <long name="Long_Field"/> <!-- mapping to LONG_FIELD column -->
            <decimal name="Decimal_Field" precision="10" scale="2" />
        </fields>
        <uniqueKey> <!-- This key means automatic key + index creation-->
            <field name="Registration_Number"/>
        </uniqueKey>
    </domain-object-type>

     <domain-object-type name="Internal_Document" initial-status="Draft"> <!-- Internal_Document table -->
        <fields>
            <string name="Name" length="128" />
            <long name="Stage"/>
            <string name="ReturnOnReject" length="3" />
            <reference name="docAuthor" type="Employee"/>
            <reference name="Registrant" type="Employee"/>
            <reference name="Inspector" type="Employee"/>
            <string name="RegNum" length="128" />
            <string name="State" length="128" />
        </fields>
    </domain-object-type>

    <domain-object-type name="Negotiation_Card"  initial-status="Draft"> <!-- Negotiation_Card table -->
        <fields>
            <string name="Name" length="128" />
            <reference name="Parent_Document" type="Internal_Document"/>
            <reference name="Negotiator" type="Employee"/>
            <reference name="Add_Negotiation_Card" type="Negotiation_Card" not-null="false"/>
            <string name="State" length="128" />
        </fields>
    </domain-object-type>

     <domain-object-type name="Examine_Card"  initial-status="Draft"> <!-- Internal_Document table -->
        <fields>
            <string name="Name" length="128" />
            <reference name="Parent_Document" type="Internal_Document"/>
            <reference name="Examiner" type="Employee"/>
            <string name="State" length="128" />
        </fields>
    </domain-object-type>

    <domain-object-type name="Resolution_Card"  initial-status="Draft"> <!-- Internal_Document table -->
        <fields>
            <string name="Name" length="128" />
            <reference name="Parent_Document" type="Internal_Document"/>
            <reference name="Executor" type="Employee"/>
            <string name="State" length="128" />
        </fields>
    </domain-object-type>

    <domain-object-type name="Assignment"> <!-- ASSIGNMENT table -->
        <fields>
            <string name="Name" length="128" />
            <string name="Description" length="128" />
            <reference name="Parent_Document" type="Outgoing_Document"/>
            <reference name="Executor" type="Employee"/> <!-- This means
             Foreign Key to Employee and index are created automatically -->
        </fields>
    </domain-object-type>

    <domain-object-type name="Person" initial-status="Active3">
        <fields>
            <string name="Login" length="128" />
            <string name="FirstName" length="128" />
            <string name="LastName" length="128" />
            <string name="EMail" length="128" />
        </fields>
       <uniqueKey> <!-- This key means automatic key + index creation-->
            <field name="Login"/>
       </uniqueKey>
       <uniqueKey> <!-- This key means automatic key + index creation-->
            <field name="EMail"/>
       </uniqueKey>
       <attachment-types>
            <attachment-type name="Person_Attachment"></attachment-type>
        </attachment-types>

    </domain-object-type>

    <!-- Системный объект, должен определяться в системной конфигурации -->
    <domain-object-type name="Authentication_Info" initial-status="Active4">
        <fields>
            <string name="User_Uid" length="64" not-null="true" />
            <password name="Password" length="128" />
        </fields>
       <uniqueKey> <!-- This key means automatic key + index creation-->
            <field name="User_Uid"/>
       </uniqueKey>
    </domain-object-type>

    <domain-object-type name="Employee_Role">
        <fields>
            <string name="Role" length="128" not-null="true" />
            <reference name="Authentication_Info" type="Authentication_Info" not-null="true"/>
        </fields>
       <uniqueKey> <!-- This key means automatic key + index creation-->
            <field name="Role"/>
       </uniqueKey>
    </domain-object-type>

	<domain-object-type name="Employee" extends="Person" audit-log="true" initial-status="Active">
		<fields>
			<reference name="Department" type="Department" not-null="true"/>
            <string name="Name" length="64" not-null="true" />
            <string name="Position" length="64" not-null="true" />
            <string name="Phone" length="32" />
            <string name="Certificate" length="4096" />
            <string name="Fingerprint" length="128" />
		</fields>
		<uniqueKey> <!-- This key means automatic key + index creation -->
			<field name="Phone" />
		</uniqueKey>
	</domain-object-type>

    <domain-object-type name="Tst_Employee" extends="Person" audit-log="true" initial-status="Active">
        <fields>
            <reference name="Department" type="*" not-null="true"/>
            <string name="Name" length="64" not-null="true" />
            <string name="Position" length="64" not-null="true" />
            <string name="Phone" length="32" />
            <string name="Certificate" length="4096" />
            <string name="Fingerprint" length="128" />
            <boolean name="HasChildren"/>
        </fields>
        <uniqueKey> <!-- This key means automatic key + index creation -->
            <field name="Phone" />
        </uniqueKey>
    </domain-object-type>

   <domain-object-type name="Delegation" initial-status="Active">
        <fields>
            <reference name="person" type="Employee" not-null="true"/>
            <reference name="delegate" type="Employee" not-null="true"/>
        </fields>
    </domain-object-type>

    <domain-object-type name="Department" audit-log="true" initial-status="Active">
        <fields>
            <string name="Name" length="128" not-null="true" />
            <reference name="Organization" type="Organization" not-null="true"/>
            <reference name="Boss" type="Employee"/>
        </fields>
    </domain-object-type>

    <domain-object-type name="Organization" audit-log="true">
        <fields>
            <string name="Name" length="128" not-null="true" />
            <reference name="Boss" type="Employee"/>
        </fields>
    </domain-object-type>

    <!-- Системные объекты, пока просто как предложение -->
    <domain-object-type name="User_Group" initial-status="Active">
        <fields>
            <string name="group_name" length="64" not-null="true" />
            <long name="object_id" />
            <long name="is_static" />
        </fields>
    </domain-object-type>

    <domain-object-type name="Group_Member" initial-status = "Active">
        <fields>
            <reference name="UserGroup" type="User_Group" not-null="true"/>
            <reference name="person_id" type="Person" not-null="true"/>
        </fields>
    </domain-object-type>

    <domain-object-type name="Group_Admin">
        <fields>
            <reference name="UserGroup" type="User_Group" not-null="true"/>
            <string name="role_name" length="64" not-null="true" />
        </fields>
    </domain-object-type>

    <domain-object-type name="Person_Task">
        <fields>
            <string name="TaskId" length="32"  not-null="true"/>
            <string name="ActivityId" length="32"  not-null="true"/>
            <string name="Name" length="512"  not-null="true"/>
            <string name="Description" length="1024" />
            <long name="Priority"/>
            <reference name="MainAttachment" type="*" not-null="true"/>
            <string name="Actions" length="512"/>
            <string name="Result" length="512"/>
            <string name="ExecutionId" length="32" />
            <long name="State"/>
        </fields>
        <uniqueKey>
            <field name="TaskId"/>
        </uniqueKey>
    </domain-object-type>

    <domain-object-type name="Task_Attachment">
        <fields>
            <reference name="PersonTask" type="Person_Task" not-null="true"/>
            <reference name="AttachmentId" type="*" not-null="true"/>
        </fields>
    </domain-object-type>

    <domain-object-type name="Assignee_Person">
        <fields>
            <reference name="PersonTask" type="Person_Task"/>
            <reference name="Person" type="Person"/>
        </fields>
    </domain-object-type>

    <domain-object-type name="Assignee_Group">
        <fields>
            <reference name="PersonTask" type="Person_Task"/>
            <reference name="UserGroup" type="User_Group"/>
        </fields>
    </domain-object-type>

    <domain-object-type name="test_process_attachment">
        <fields>
        	<string name="test_text" length="512"/>
			<dateTime name="test_date"/>
			<long name="test_long"/>
			<decimal name="test_decimal" precision="10" scale="2"/>
            <string name="new_field" length="512"/>
        </fields>
    </domain-object-type>

    <domain-object-type name="group_group_settings">
        <fields>
            <reference name="parent_group_id" type="User_Group"/>
            <reference name="child_group_id" type="User_Group"/>
        </fields>
        <!-- uniqueKey>
            <field name="parent_group_id"/>
            <field name="child_group_id"/>
        </uniqueKey-->
    </domain-object-type>

    <domain-object-type name="group_group">
        <fields>
            <reference name="parent_group_id" type="User_Group"/>
            <reference name="child_group_id" type="User_Group"/>
        </fields>
        <!-- uniqueKey>
            <field name="parent_group_id"/>
            <field name="child_group_id"/>
        </uniqueKey-->
    </domain-object-type>

</configuration>
