<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<configuration xmlns="https://cm5.intertrust.ru/config" xmlns:act="https://cm5.intertrust.ru/config/action">
    <domain-object-type name="letter" initial-status="Active">
        <fields>
            <string name="subject" length="128"/>
            <string name="password" length="128" encrypted="true"/>
            <date-time name="actual_start_period"/>
            <date-time name="actual_end_period"/>
            <long name="priority"/>
            <string name="receiver_status" length="20"/>
            <string name="category" length="500"/>
        </fields>
    </domain-object-type>
    <domain-object-type name="letter_creator" initial-status="Active">
        <fields>
            <reference name="letter" type="letter"/>
            <reference name="employee" type="Employee"/>
        </fields>
    </domain-object-type>
    <domain-object-type name="letter_addressee">
        <fields>
            <reference name="letter" type="letter"/>
        </fields>
    </domain-object-type>

    <domain-object-type name="organization_addressee" extends="letter_addressee">
        <fields>
            <reference name="organization" type="Organization"/>
        </fields>
    </domain-object-type>

    <domain-object-type name="department_addressee" extends="letter_addressee">
        <fields>
            <reference name="department" type="Department"/>
        </fields>
    </domain-object-type>

    <domain-object-type name="employee_addressee" extends="letter_addressee">
        <fields>
            <reference name="employee" type="Employee"/>
        </fields>
    </domain-object-type>

    <form name="org_middle_form" domain-object-type="org_middle" is-default="true">
        <markup>
            <header>
                <table>
                    <tr>
                        <td width="100px" h-align="right">
                            <widget id="name_label"/>
                        </td>
                        <td width="100%" h-align="left">
                            <widget id="name"/>
                        </td>
                    </tr>
                </table>
            </header>
            <body display-single-tab="false">
                <tab name="Главная">
                    <single-entry-group>
                        <tab-group>
                            <table>
                                <tr>
                                    <td h-align="right">
                                        <widget id="org_label"/>
                                    </td>
                                    <td h-align="left">
                                        <widget id="org"/>
                                    </td>
                                </tr>
                            </table>
                        </tab-group>
                    </single-entry-group>
                </tab>

            </body>
        </markup>
        <widget-config>
            <label id="name_label">
                <field-path/>
                <text>Имя:</text>
            </label>
            <text-box id="name">
                <field-path value="name"/>
            </text-box>

            <label id="org_label">
                <text>Организация:</text>
            </label>

            <!-- <list-box id="addressees">
                 <field-path value="organization_addressee^letter.organization, department_addressee^letter.department, employee_addressee^letter.employee"/>
                 <pattern value="{Name}"/>
             </list-box>-->
            <suggest-box id="org">
                <field-path value="organization"/>

                <collection-ref name="Organizations"/>

                <!-- паттерн отображения значений выпадающего списка -->
                <drop-down-pattern value="{name}"/>

                <!-- паттерн отображения уже выбранных значений -->
                <selection-pattern value="{name}"/>

                <!-- название фильтра по тексту, введённому пользователем -->
                <input-text-filter name="byText"/>

                <!-- количество элементов, показываемых на одной странице выпадающего списка -->
                <page-size>30</page-size>

                <!--name может принимать 2 значения inline (стиль Студии Лебедева) и table (текущая реализация).
                    Если тэг отсутствует, то используется "inline"-вариант. -->
                <selection-style name="inline"/>
                <single-choice value="true"/>
                <clear-all-button text="Очистить"/>
                <default-sort-criteria column-field="name" order="asc"/>
            </suggest-box>
        </widget-config>
    </form>


    <form name="letter_form" domain-object-type="letter" is-default="true">
        <markup>
            <header>
                <table>
                    <tr>
                        <td width="100px" h-align="right">
                            <widget id="subject_label"/>
                        </td>
                        <td width="200px" h-align="left">
                            <widget id="subject"/>
                        </td>
                        <td width="100px" h-align="right">
                            <widget id="password_label"/>
                        </td>
                        <td width="100px" h-align="left">
                            <widget id="password"/>
                        </td>
                    </tr>
                </table>
            </header>
            <body display-single-tab="false">
                <tab name="Главная">
                    <single-entry-group>
                        <tab-group>
                            <table>
                                <tr>
                                    <td h-align="right">
                                        <widget id="addressees_label"/>
                                    </td>
                                    <td h-align="left">
                                        <widget id="addressees_label"/>
                                        <!--<widget id="addressees"/>-->
                                    </td>
                                </tr>
                                <tr>
                                    <td h-align="left">
                                        <widget id="actual_start_period_label"/>
                                    </td>
                                    <td h-align="left">
                                        <widget id="actual_start_period"/>
                                    </td>
                                    <td h-align="right">
                                        <widget id="actual_end_period_label"/>
                                    </td>
                                    <td h-align="left">
                                        <widget id="actual_end_period"/>
                                    </td>
                                    <td h-align="left">
                                        <widget id="letter_creators_label"/>
                                    </td>
                                    <td h-align="left">
                                        <widget id="letter_creators"/>
                                    </td>
                                    <td>
                                        <widget id="letter_priority_label"/>
                                    </td>
                                    <td>
                                        <widget id="letter_priority"/>
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        <widget id="status_label"/>
                                    </td>
                                    <td h-align="left">
                                        <widget id="status"/>
                                    </td>

                                </tr>

                            </table>
                        </tab-group>
                    </single-entry-group>
                </tab>
                <tab name="Иерархический браузер">
                    <single-entry-group>
                        <tab-group>
                            <table>
                                <tr>
                                    <td>
                                        <widget id="2c"/>
                                    </td>
                                </tr>
                            </table>
                        </tab-group>
                    </single-entry-group>
                </tab>
                <tab name="LinkDomainHyperlink">
                    <single-entry-group>
                        <tab-group>
                            <table>
                                <tr>
                                    <td>
                                        <widget id="l_hyperlink"/>
                                    </td>
                                </tr>
                            </table>
                        </tab-group>
                    </single-entry-group>
                </tab>
                <tab name="TableBrowserDemo">
                    <single-entry-group>
                        <tab-group>
                            <table>
                                <tr>
                                    <td>
                                        <widget id="l_tablebrowser"/>
                                    </td>
                                </tr>
                            </table>
                        </tab-group>
                    </single-entry-group>
                </tab>
                <tab name="SuggestBoxDemo">
                    <single-entry-group>
                        <tab-group>
                            <table>
                                <tr>
                                    <td>
                                        <widget id="l_suggestbox"/>
                                    </td>
                                </tr>
                            </table>
                        </tab-group>
                    </single-entry-group>
                </tab>
                <tab name="LinkedObjectsTableDemo">
                    <single-entry-group>
                        <tab-group>
                            <table>
                                <tr>
                                    <td>
                                        <widget id="l_linkedtable"/>
                                    </td>
                                </tr>
                            </table>
                        </tab-group>
                    </single-entry-group>
                </tab>
                <tab name="TableViewerDemo">
                    <single-entry-group>
                        <tab-group>
                            <table>
                                <tr>
                                    <!-- label (Сама информация) -->
                                    <td colspan="3" h-align="left">
                                        <widget id="table-viewer"/>
                                    </td>
                                </tr>
                            </table>
                        </tab-group>
                    </single-entry-group>
                </tab>
                <tab name="RecursiveHierarchyBrowser">
                    <single-entry-group>
                        <tab-group>
                            <table>
                                <tr>
                                    <!-- label (Сама информация) -->
                                    <td colspan="3" h-align="left">
                                        <widget id="recursive"/>
                                    </td>
                                </tr>
                            </table>
                        </tab-group>
                    </single-entry-group>
                </tab>
                <tab name="EditableTableBrowserDemo">
                    <single-entry-group>
                        <tab-group>
                            <table height="200px">
                                <tr>
                                    <td v-align="top">
                                        <widget id="l_editabletablebrowser"/>
                                    </td>
                                </tr>
                            </table>
                        </tab-group>
                    </single-entry-group>
                </tab>
            </body>
        </markup>
        <widget-config>
            <label id="letter_creators_label">
                <field-path/>
                <text>Создатели письма:</text>
            </label>
            <suggest-box id="letter_creators">
                <field-path value="letter_creator^letter.employee"/>
                <collection-ref name="Employees"/>
                <drop-down-pattern value="{name}"/>
                <selection-pattern value="{name}"/>
                <input-text-filter name="byFirstLetter"/>
                <page-size>20</page-size>
                <single-choice value="false"/>
                <clear-all-button text="Очистить"/>
            </suggest-box>
            <label id="subject_label">
                <field-path/>
                <text>Тема:</text>
            </label>
            <text-box id="subject">
                <field-path value="subject">
                    <default-value>
                        <field value="Тема по умолчанию (из widget-config)"/>
                    </default-value>
                </field-path>
            </text-box>
            <label id="password_label">
                <field-path/>
                <text>Пароль:</text>
            </label>
            <text-box id="password">
                <field-path value="password"/>
            </text-box>

            <label id="addressees_label">
                <text>Адресаты:</text>
            </label>

            <label id="letter_priority_label">
                <field-path/>
                <text>Приоритет:</text>
            </label>
            <linked-domain-objects-table id="l_linkedtable">
                <field-path
                        value="organization_addressee^letter.organization, department_addressee^letter.department, employee_addressee^letter.employee"/>
                <linked-form name="organization_form" inline="true"/>
                <linked-form-mapping>
                    <linked-form name="organization_form" domain-object-type="Organization" modal-height="400px"
                                 modal-width="800px" resizable="true"/>
                    <linked-form name="department_form" domain-object-type="Department"
                                 multi-form-name="free_form"  multi-form-handler="TestFreeFormHandler"/>
                    <linked-form name="employee_form" domain-object-type="Employee"/>
                </linked-form-mapping>
                <created-objects>
                    <created-object text="Организация" domain-object-type="Organization"/>
                    <created-object text="Отдел" domain-object-type="Department"/>
                    <created-object text="Сотрудник" domain-object-type="Employee"/>
                </created-objects>

                <summary-table>
                    <summary-table-column header="Название" widget-id="Name">
                        <action component-name="default.linked.table.action"
                                access-checker="attachment.read.access.checker"
                                new-objects-access-checker="attachment.write.access.checker"
                                tooltip="Скачать">
                            <display position="before" tooltip="Скачать">
                                <image url="/images/icons/ico-save.gif"/>
                                <text value="Скачать"/>
                            </display>
                        </action>

                        <pattern value="{name} {description} - Organization">
                            <domain-object-types>
                                <domain-object-type name="Organization"/>
                            </domain-object-types>
                        </pattern>

                        <pattern value="{name} - Department">
                            <domain-object-types>
                                <domain-object-type name="Department"/>
                            </domain-object-types>
                        </pattern>
                        <pattern value="{name}"/>
                        <!-- пути задаются относительно базового field-path (correspondent) -->
                        <formatting>
                            <number-format pattern="###.####">
                                <field-paths> <!-- описание путей к полям, к которым применяется форматирование -->
                                    <field-path value="age"/>
                                    <field-path value="age"/>
                                </field-paths>
                            </number-format>
                            <date-format pattern="dd-mm-yyyy" style="short">
                                <field-paths>
                                    <field-path value="date_of_birth"/>
                                </field-paths>
                            </date-format>
                        </formatting>
                    </summary-table-column>
                    <summary-table-column header="Название - generated" widget-id="Description"
                                          column-renderer-component="summarytable.column.renderer">
                        <pattern value="{name} {description} - Organization">
                            <domain-object-types>
                                <domain-object-type name="Organization"/>
                            </domain-object-types>
                        </pattern>
                        <pattern value="{name} - Department">
                            <domain-object-types>
                                <domain-object-type name="Department"/>
                            </domain-object-types>
                        </pattern>
                        <pattern value="{name}"/>
                        <!-- пути задаются относительно базового field-path (correspondent) -->
                        <formatting>
                            <number-format pattern="###.####">
                                <field-paths> <!-- описание путей к полям, к которым применяется форматирование -->
                                    <field-path value="age"/>
                                    <field-path value="age"/>
                                </field-paths>
                            </number-format>
                            <date-format pattern="dd-mm-yyyy" style="short">
                                <field-paths>
                                    <field-path value="date_of_birth"/>
                                </field-paths>
                            </date-format>
                        </formatting>
                    </summary-table-column>
                </summary-table>
                <collection-ref name="Organizations"/>
                <!--<selection-filters>
                    <selection-filter name="byNames">
                        <param name="0" value="Организация 11" type="string"/>
                        <param name="1" value="Организация 1" type="string"/>
                        <param name="2" value="Организация 2" type="string"/>
                        <param name="3" value="Организация 22" type="string"/>
                    </selection-filter>
                </selection-filters>-->
            </linked-domain-objects-table>

            <suggest-box id="l_suggestbox">
                <field-path
                        value="organization_addressee^letter.organization, department_addressee^letter.department, employee_addressee^letter.employee"/>
                <collection-ref name="Organizations"/>

                <!-- паттерн отображения уже выбранных значений -->
                <selection-pattern value="{name}, начальник {boss_name}"/>
                <drop-down-pattern value="{name}"/>
                <!-- название фильтра по тексту, введённому пользователем -->
                <input-text-filter name="byName"/>

                <!-- количество элементов, показываемых на одной странице выпадающего списка. в правом нижнем углу
                под таблицей указатель страниц (за пример нужно взять страницы поиска в Яндексе) -->
                <page-size>30</page-size>
                <selection-style name="inline"/>
                <single-choice value="false"/>
                <clear-all-button text="Очистить"/>
                <default-sort-criteria column-field="name" order="desc"/>
                <display-values-as-links value="true" modal-window="false"/>
                <linked-form-mapping>
                    <linked-form name="organization_form" domain-object-type="Organization" resizable="true"/>
                    <linked-form name="department_form" domain-object-type="Department"/>
                    <linked-form name="employee_form" domain-object-type="Employee">
                        <title>
                            <existing-object>
                                <pattern value="{id}, {created_date}"/>
                                <formatting>
                                    <date-format pattern="dd-mm-yyyy HH-mm-ss" style="short">
                                        <time-zone id="Europe/Kiev"/>
                                        <field-paths>
                                            <field-path value="created_date"/>
                                        </field-paths>
                                    </date-format>
                                </formatting>
                            </existing-object>
                            <new-object>
                                <pattern value="new form "/>
                            </new-object>
                        </title>
                    </linked-form>
                    <linked-form name="developer_form2" domain-object-type="Developer"/>
                </linked-form-mapping>
                <create-new-button text="Создать"/>
                <created-objects>
                    <created-object domain-object-type="Organization" text="Организация"/>
                    <created-object domain-object-type="Employee" text="Сотрудник"/>
                    <created-object domain-object-type="Developer" text="Разработчки"/>
                </created-objects>
                <collection-extra-filters>
                    <!-- example with widget-id, create new Organization with status "Pretermit",
                    chose letter status "Pretermit"-->
                    <extra-filter name="byStatus" null-value-filter-name="nullBossFilter">
                        <param name="0" widget-id="status"/>
                    </extra-filter>

                    <!-- two simple string params example-->
                    <!-- <extra-filter name="byNames">
                         <param name="0" value="Организация 1" type="string"/>
                         <param name="1" value="Организация 2" type="string"/>
                     </extra-filter>-->

                    <!-- current user example, login person1/admin, create new  organization via hierarchy browser-->
                    <!--<extra-filter name="byCreator">
                        <param name="0" set-current-user="true"/>
                    </extra-filter>-->

                    <!-- filter organizations by boss employee with phone number "8 (495) 777-55-01"   -->

                    <!--<extra-filter name="byEmployee">
                        <param name="0" type="reference">
                            <unique-key-value type="Employee">
                                <field name="Phone" value="8 (495) 999-55-01"/>
                            </unique-key-value>
                        </param>
                    </extra-filter>-->

                    <!-- current date example-->
                    <!-- <extra-filter name="byCreatedDate">
                         <param name="0" set-current-moment="true" type="datetime"/>
                     </extra-filter>-->
                    <!-- <param name="6" set-base-object="true"/>-->
                </collection-extra-filters>
            </suggest-box>

            <table-browser id="l_tablebrowser" resizable="true">
                <dialog-window resizable="true" height="400px" width="700px"/>
                <field-path
                        value="organization_addressee^letter.organization, department_addressee^letter.department, employee_addressee^letter.employee"/>
                <collection-ref name="Organizations"/>
                <collection-view-ref name="organizations_default_view"/>

                <!-- паттерн отображения уже выбранных значений -->
                <selection-pattern value="{name}"/>

                <!-- название фильтра по тексту, введённому пользователем -->
                <input-text-filter name="byName"/>

                <!-- количество элементов, показываемых на одной странице выпадающего списка. в правом нижнем углу
                под таблицей указатель страниц (за пример нужно взять страницы поиска в Яндексе) -->

                <!--page-size>30</page-size-->
                <display-chosen-values value="false"/>
                <selection-style name="inline"/>
                <single-choice value="false"/>
                <clear-all-button text="Очистить"/>
                <add-button image="..." text="Выбрать"/>
                <default-sort-criteria column-field="name" order="desc"/>
                <display-values-as-links value="true" modal-window="false"/>

                <linked-form-mapping>
                    <linked-form name="organization_form" domain-object-type="Organization" modal-height="300px"
                                 modal-width="700px" resizable="true"/>
                    <linked-form name="department_form" domain-object-type="Department"/>
                    <linked-form name="employee_form" domain-object-type="Employee"/>
                    <linked-form name="developer_form2" domain-object-type="Developer">
                        <title>
                            <existing-object>
                                <pattern value="{id}, {created_date}"/>
                                <formatting>
                                    <date-format pattern="dd-mm-yyyy HH-mm-ss" style="short">
                                        <time-zone id="Europe/Kiev"/>
                                        <field-paths>
                                            <field-path value="created_date"/>
                                        </field-paths>
                                    </date-format>
                                </formatting>
                            </existing-object>
                            <new-object>
                                <pattern value="new form "/>

                            </new-object>
                        </title>
                    </linked-form>
                </linked-form-mapping>
                <create-new-button text="Создать"/>
                <created-objects>
                    <created-object domain-object-type="Organization" text="Организация"/>
                    <created-object domain-object-type="Employee" text="Сотрудник"/>
                    <created-object domain-object-type="Developer" text="Разработчки"/>
                </created-objects>
                <selection-filters>
                    <selection-filter name="byNames">
                        <param name="0" value="Организация 11" type="string"/>
                        <param name="1" value="Организация 1" type="string"/>
                        <param name="2" value="Организация 2" type="string"/>
                        <param name="3" value="Организация 22" type="string"/>
                    </selection-filter>
                </selection-filters>
            </table-browser>


            <editable-table-browser id="l_editabletablebrowser" resizable="true" autosuggest-allowed="true">
                <field-path value="category"/>

                <collection-ref name="Organizations"/>
                <collection-view-ref name="organizations_default_view"/>
                <selection-pattern value="{name}"/>
                <input-text-filter name="byName"/>
                <page-size>30</page-size>
                <display-chosen-values value="false"/>
                <selection-style name="inline"/>
                <default-sort-criteria column-field="name" order="desc"/>
                <dialog-window resizable="true" height="400px" width="700px"/>
                <display-values-as-links value="true" modal-window="false"/>
                <select-button image="..." text="Выбрать"/>
                <default-button text="По умолч."/>
                <drop-down-pattern value="{name}"/>
            </editable-table-browser>

            <linked-domain-object-hyperlink id="l_hyperlink" modal-window="true">
                <field-path
                        value="organization_addressee^letter.organization, department_addressee^letter.department, employee_addressee^letter.employee"/>
                <linked-form name="organization_form"/>
                <linked-form-mapping>
                    <linked-form name="organization_form" domain-object-type="Organization"/>
                    <linked-form name="department_form" domain-object-type="Department"/>
                    <linked-form name="employee_form" domain-object-type="Employee"/>
                    <linked-form name="developer_form2" domain-object-type="Developer"/>
                </linked-form-mapping>
                <collection-ref name="Organizations"/>
                <selection-filters>
                    <selection-filter name="byNames">
                        <param name="0" value="Организация 11" type="string"/>
                        <param name="1" value="Организация 1" type="string"/>
                        <param name="2" value="Организация 2" type="string"/>
                        <param name="3" value="Организация 22" type="string"/>
                    </selection-filter>

                </selection-filters>
                <pattern value="{name}"/>
            </linked-domain-object-hyperlink>

            <enumeration-box id="letter_priority">
                <field-path value="priority">
                    <default-value>
                        <field name="priority" value="2"/>
                    </default-value>
                </field-path>
                <mapping>
                    <map value="1" display-text="низкий"/>
                    <map value="2" display-text="обычный"/>
                    <map value="3" display-text="срочный"/>
                </mapping>
            </enumeration-box>

            <hierarchy-browser id="recursive">
                <field-path
                        value="organization_addressee^letter.organization, department_addressee^letter.department"/>
                <dialog-window resizable="true" width="900" height="300"/>
                <node-collection-def collection="organizations"
                                     title="Организацию">
                    <root-node-link title="Организации"/>
                    <!-- название фильтра по тексту, введённому пользователем -->
                    <input-text-filter name="byName"/>
                    <!-- паттерн отображения уже выбранных значений -->
                    <selection-pattern value="{name}"/>
                    <default-sort-criteria column-field="name" order="asc"/>
                    <selection-filters>
                        <selection-filter name="byNames">
                            <param name="0" value="Организация 9" type="string"/>
                            <param name="1" value="Организация 10" type="string"/>
                            <param name="2" value="Организация 2" type="string"/>
                            <param name="3" value="Организация 22" type="string"/>
                        </selection-filter>
                    </selection-filters>
                    <selection-sort-criteria>
                        <sort-criterion field="name" order="asc"/>
                    </selection-sort-criteria>

                    <created-objects>
                        <created-object text="Орг" domain-object-type="Organization"/>
                    </created-objects>
                    <linked-form-mapping>

                        <linked-form name="organization_form" domain-object-type="organization"/>

                    </linked-form-mapping>
                    <!--<selection-filters row-limit="1"></selection-filters>-->
                    <node-collection-def collection="departments"
                                         title="Департамент" display-create-button="true">
                        <single-choice>
                            <parent-object-field name="name" value="Организация 1"/>
                        </single-choice>
                        <fill-parent-on-add field-to-fill="organization"/>
                        <linked-form-mapping>
                            <linked-form name="department_form" domain-object-type="department">
                                <title>
                                    <existing-object>
                                        <pattern value="{id}, {created_date}"/>
                                        <formatting>
                                            <date-format pattern="dd-mm-yyyy HH-mm-ss" style="short">
                                                <time-zone id="Europe/Kiev"/>
                                                <field-paths>
                                                    <field-path value="created_date"/>
                                                </field-paths>
                                            </date-format>
                                        </formatting>
                                    </existing-object>
                                    <new-object>
                                        <pattern value="new form "/>

                                    </new-object>
                                </title>

                            </linked-form>
                        </linked-form-mapping>
                        <create-new-button text="Department" image="images/icons/arrow-down.png"/>

                        <display-values-as-links value="false"/>
                        <input-text-filter name="byName"/>
                        <!-- паттерн отображения уже выбранных значений -->
                        <selection-pattern value="{name}"/>

                        <node-collection-def collection="departments" parent-filter="byParentDepartment"
                                             title="Департамент" display-create-button="true">
                            <single-choice>
                                <parent-object-field name="name" value="Организация 1"/>
                            </single-choice>
                            <fill-parent-on-add field-to-fill="organization"/>
                            <linked-form-mapping>
                                <linked-form name="department_form" domain-object-type="department">
                                    <title>
                                        <existing-object>
                                            <pattern value="{id}, {created_date}"/>
                                            <formatting>
                                                <date-format pattern="dd-mm-yyyy HH-mm-ss" style="short">
                                                    <time-zone id="Europe/Kiev"/>
                                                    <field-paths>
                                                        <field-path value="created_date"/>
                                                    </field-paths>
                                                </date-format>
                                            </formatting>
                                        </existing-object>
                                        <new-object>
                                            <pattern value="new form "/>

                                        </new-object>
                                    </title>

                                </linked-form>
                            </linked-form-mapping>
                            <create-new-button text="Department" image="images/icons/arrow-down.png"/>

                            <display-values-as-links value="false"/>
                            <input-text-filter name="byName"/>
                            <!-- паттерн отображения уже выбранных значений -->
                            <selection-pattern value="{name}"/>
                            <!-- путь к узлу верхнего уровня (относительно пути этого узла) от узла данного уровня -->

                        </node-collection-def>
                        <node-collection-def collection="employees" parent-filter="byDepartment">
                            <single-choice value="true"/>
                            <!-- название фильтра по тексту, введённому пользователем -->
                            <fill-parent-on-add field-to-fill="department"/>
                            <input-text-filter name="byName"/>
                            <!-- паттерн отображения уже выбранных значений -->
                            <selection-pattern value="{name} {position}"/>
                            <linked-form-mapping>
                                <linked-form name="employee_form" domain-object-type="employee" modal-height="500px"
                                             modal-width="400px"/>
                            </linked-form-mapping>
                        </node-collection-def>
                    </node-collection-def>
                </node-collection-def>


                <!-- количество элементов, показываемых в данном узле дерева изначально -->
                <page-size>10</page-size>
                <single-choice value="true"/>
                <clear-all-button text="Очистить"/>
                <add-button image="..." text="Добавить"/>
                <display-values-as-links value="true" modal-window="false"/>

            </hierarchy-browser>
            <hierarchy-browser id="2c">
                <dialog-window height="300px" width="800px" resizable="true"/>
                <field-path
                        value="organization_addressee^letter.organization, department_addressee^letter.department, employee_addressee^letter.employee"/>

                <!-- Определение списка/таблицы, выпадающего при раскрытии узла -->
                <!-- Уже выбранные элементы показываются помеченными галочками -->
                <!-- collection - название коллекции для отображения списка значений узла -->

                <node-collection-def collection="organizations"
                                     title="Организацию">
                    <root-node-link title="Организации"/>
                    <!-- название фильтра по тексту, введённому пользователем -->
                    <input-text-filter name="byName"/>
                    <!-- паттерн отображения уже выбранных значений -->
                    <selection-pattern value="{name}"/>
                    <collection-extra-filters>
                        <extra-filter name="byBossName">
                            <param name="0" type="string" value="Сотрудник 1"/>
                        </extra-filter>
                    </collection-extra-filters>
                    <default-sort-criteria column-field="name" order="asc"/>
                    <!--<selection-filters >
                        <selection-filter name="byNames">
                            <param name="0" value="Организация 9" type="string"/>
                            <param name="1" value="Организация 10" type="string"/>
                            <param name="2" value="Организация 2" type="string"/>
                            <param name="3" value="Организация 22" type="string"/>
                        </selection-filter>
                    </selection-filters>-->
                    <selection-sort-criteria>
                        <sort-criterion field="name" order="asc"/>
                    </selection-sort-criteria>

                    <created-objects>
                        <created-object text="Орг" domain-object-type="Organization"/>
                    </created-objects>
                    <linked-form-mapping>

                        <linked-form name="organization_form" domain-object-type="organization" modal-height="500px"
                                     modal-width="400px" resizable="true"/>

                    </linked-form-mapping>
                    <!--<selection-filters row-limit="1"></selection-filters>-->
                    <node-collection-def collection="departments" parent-filter="byOrganization"
                                         title="Департамент" display-create-button="false">
                        <single-choice value="true"/>
                        <fill-parent-on-add field-to-fill="organization"/>
                        <linked-form-mapping>
                            <linked-form name="department_form" domain-object-type="department">
                                <title>
                                    <existing-object>
                                        <pattern value="{id}, {created_date}"/>
                                        <formatting>
                                            <date-format pattern="dd-mm-yyyy HH-mm-ss" style="short">
                                                <time-zone id="Europe/Kiev"/>
                                                <field-paths>
                                                    <field-path value="created_date"/>
                                                </field-paths>
                                            </date-format>
                                        </formatting>
                                    </existing-object>
                                    <new-object>
                                        <pattern value="new form "/>

                                    </new-object>
                                </title>

                            </linked-form>
                        </linked-form-mapping>
                        <create-new-button text="Department" image="images/icons/arrow-down.png"/>

                        <display-values-as-links value="false"/>
                        <input-text-filter name="byName"/>
                        <!-- паттерн отображения уже выбранных значений -->
                        <selection-pattern value="{name}"/>
                        <!-- путь к узлу верхнего уровня (относительно пути этого узла) от узла данного уровня -->
                        <node-collection-def collection="employees" parent-filter="byDepartment">
                            <single-choice value="true"/>
                            <!-- название фильтра по тексту, введённому пользователем -->
                            <fill-parent-on-add field-to-fill="department"/>
                            <input-text-filter name="byName"/>
                            <!-- паттерн отображения уже выбранных значений -->
                            <selection-pattern value="{name} {position}"/>
                            <linked-form-mapping>
                                <linked-form name="employee_form" domain-object-type="employee" modal-height="500px"
                                             modal-width="400px"/>
                            </linked-form-mapping>
                        </node-collection-def>
                    </node-collection-def>
                    <node-collection-def collection="employeesWithOrganization" parent-filter="byOrganization"
                                         title="Сотрудника">
                        <create-new-button text="Создать"/>
                        <fill-parent-on-add field-to-fill="organization"/>
                        <input-text-filter name="byText"/>
                        <!-- паттерн отображения уже выбранных значений -->
                        <selection-pattern value="{name} {position}"/>
                        <created-objects>
                            <created-object text="Сотрудник" domain-object-type="employee"/>
                            <created-object text="Разработчик" domain-object-type="Developer"/>
                        </created-objects>
                        <linked-form-mapping>
                            <linked-form name="employee_form" domain-object-type="employee"/>
                            <linked-form name="developer_form2" domain-object-type="developer"/>
                        </linked-form-mapping>
                    </node-collection-def>
                </node-collection-def>

                <!-- количество элементов, показываемых в данном узле дерева изначально -->
                <page-size>10</page-size>
                <single-choice value="false"/>
                <clear-all-button text="Очистить"/>
                <add-button image="..." text="Добавить"/>
                <display-values-as-links value="true"/>

            </hierarchy-browser>
            <label id="actual_start_period_label">
                <text>Актуально с:</text>
            </label>
            <label id="actual_end_period_label">
                <text>Актуально по:</text>
            </label>
            <date-box id="actual_start_period">
                <field-path value="actual_start_period"/>
                <range-end widget-id="actual_end_period"/>
            </date-box>
            <date-box id="actual_end_period">
                <field-path value="actual_end_period"/>
                <range-start widget-id="actual_start_period"/>
            </date-box>
            <label id="status_label">
                <text>Статус:</text>
            </label>
            <enumeration-box id="status">
                <field-path value="receiver_status"/>
                <mapping>
                    <map value="Active" display-text="Active"/>
                    <map value="Pretermit" display-text="Pretermit"/>

                </mapping>
            </enumeration-box>
            <table-viewer id="table-viewer" edit-component="abra.cabra">
                <page-size>10</page-size>
                <ignore-form-read-only-state value="false"/>
                <collection-viewer>
                    <collection-ref name="Organizations"/>
                    <collection-view-ref name="organizations_default_view"/>
                    <default-sort-criteria column-field="name" order="desc"/>

                    <act:tool-bar useDefault="true">
                        <act:action name="oAction" componentName="ordinary.action" text="Тест Ordinary Action"
                        />
                        <act:simple-action componentName="simple.action" action-handler="test.simple.action"
                                           text="Тест SimpleAction"/>
                    </act:tool-bar>
                    <rows-selection default-state="empty" multi-selection="true"/>
                </collection-viewer>
                <collection-table-buttons display-all-possible="false"/>
                <linked-form-mapping>
                    <linked-form name="organization_form" domain-object-type="Organization" modal-height="400px"
                                 modal-width="800px" resizable="true"/>
                    <linked-form name="department_form" domain-object-type="Department" modal-height="400px"
                                 modal-width="600px"/>
                    <linked-form name="employee_form" domain-object-type="Employee" modal-height="400px"
                                 modal-width="600px"/>
                </linked-form-mapping>
                <created-objects>
                    <created-object domain-object-type="Organization" text="Организация"/>
                    <created-object domain-object-type="Department" text="Подразделение"/>
                    <created-object domain-object-type="Employee" text="Сотрудник"/>
                </created-objects>

            </table-viewer>
        </widget-config>
    </form>

    <form name="employee_form" domain-object-type="Employee" is-default="true">
        <markup>
            <header>
                <table>
                    <tr>
                        <td width="100px" h-align="right">
                            <widget id="Name-Label"/>
                        </td>
                        <td width="100%" h-align="left">
                            <widget id="Name"/>
                        </td>
                        <!-- text-box (Название) -->
                    </tr>
                </table>
            </header>
            <body display-single-tab="false"> <!-- в теле - только закладки -->
                <tab name="Главная"> <!-- закладка состоит из групп с разметкой -->
                    <single-entry-group> <!-- наследник от TabGroupsConfig -->
                        <tab-group> <!-- вхождение в группу уже может содержать разметку -->
                            <table>
                                <tr>
                                    <td h-align="right">
                                        <widget id="Department-Label"/>
                                    </td>
                                    <td h-align="left">
                                        <widget id="Department"/>
                                    </td>
                                </tr>
                                <tr>
                                    <td h-align="right">
                                        <widget id="positionLabel"/>
                                    </td>
                                    <td h-align="left">
                                        <widget id="position"/>
                                    </td>

                                    <td h-align="left">
                                        <widget id="hyperlink"/>
                                    </td>
                                    <td h-align="left">
                                        <widget id="label_empty_values"/>
                                    </td>

                                </tr>
                            </table>
                        </tab-group>
                    </single-entry-group>
                </tab>
            </body>
        </markup>
        <widget-config>
            <label id="Name-Label">
                <field-path/>
                <relates-to widget-id="Name"/>
                <text>Название:</text>
            </label>
            <text-box id="Name">
                <field-path value="Name"/>
            </text-box>

            <label id="Department-Label">
                <relates-to widget-id="Department"/>
                <text>Департамент:</text>
            </label>
            <combo-box id="Department">
                <field-path value="Department"/>
                <pattern value="{Name}"/>
            </combo-box>

            <label id="positionLabel">
                <relates-to widget-id="position"/>
                <text>Должность:</text>
            </label>
            <text-box id="position">
                <field-path value="Position"/>
            </text-box>
            <linked-domain-object-hyperlink id="hyperlink"
                                            modal-window="false"> <!-- для единичного связанного объекта -->
                <field-path value="department"/>
                <!-- для связанных объектов field-path обязательно должен ссылаться на поле типа reference -->
                <linked-form name="department_form2">
                    <title>
                        <existing-object>
                            <pattern value="{id}, {created_date}"/>
                            <formatting>
                                <date-format pattern="dd-mm-yyyy HH-mm-ss" style="short">
                                    <time-zone id="Europe/Kiev"/>
                                    <field-paths>
                                        <field-path value="created_date"/>
                                    </field-paths>
                                </date-format>
                            </formatting>
                        </existing-object>
                        <new-object>
                            <pattern value="new form "/>

                        </new-object>
                    </title>
                </linked-form>
                <!-- форма, открывающаяся в модальном окне при нажатии на гиперссылку -->
                <pattern value="{name} {created_date}"/>
                <!-- в паттерне ссылки задаются относительно field-path -->
                <formatting>

                    <date-format pattern="dd-mm-yyyy HH:mm:ss" style="short">
                        <time-zone id="Europe/Kiev"/>
                        <field-paths>
                            <field-path value="created_date"/>
                        </field-paths>
                    </date-format>
                </formatting>
            </linked-domain-object-hyperlink>

            <label id="label_empty_values">
                <field-path value="phone, certificate"/>
                <font-weight value="bolder"/>
                <font-style value="italic"/>
                <font-size value="8px"/>
                <pattern value="{phone}, {certificate}"/>
                <all-values-empty-message value="Номер телефона: сертификат:"/>
            </label>
        </widget-config>
    </form>

    <form name="department_form" domain-object-type="Department" is-default="true"
          default-value-setter="department.form.value.setter">
        <default-value-setter component="department.form.value.setter">
            <widget-states>
                <editable/>
            </widget-states>
        </default-value-setter>
        <markup>
            <header>
                <table>
                    <tr>
                        <td width="100px" h-align="right">
                            <widget id="Name-Label"/>
                        </td>
                        <td width="100%" h-align="left">
                            <widget id="Name"/>
                        </td>
                        <!-- text-box (Название) -->
                    </tr>
                </table>
            </header>
            <body display-single-tab="false">
            </body>
        </markup>
        <widget-config>
            <label id="Name-Label">
                <field-path/>
                <relates-to widget-id="Name"/>
                <text>Название:</text>
            </label>
            <text-box id="Name">
                <field-path value="Name"/>
            </text-box>
        </widget-config>
    </form>
    <form name="department_form2" domain-object-type="Department" is-default="false">
        <markup>
            <header>
                <table>
                    <tr>
                        <td width="100px" h-align="right">
                            <widget id="Name-Label"/>
                        </td>
                        <td width="50%" h-align="left">
                            <widget id="Name"/>
                        </td>
                        <td width="50%" h-align="left">
                            <widget id="Organization"/>
                        </td>
                        <!-- text-box (Название) -->
                    </tr>
                </table>
            </header>
            <body display-single-tab="false"> <!-- в теле - только закладки -->

            </body>
        </markup>
        <widget-config>
            <label id="Name-Label">
                <field-path/>
                <relates-to widget-id="Name"/>
                <text>Полное имя:</text>
            </label>
            <text-box id="Name">
                <field-path value="Name"/>
            </text-box>

            <label id="Organization-Label">
                <relates-to widget-id="Organization"/>
                <text>Организация:</text>
            </label>
            <combo-box id="Organization">
                <field-path value="Organization"/>
                <pattern value="{Name}"/>
            </combo-box>
        </widget-config>
    </form>

    <form name="organization_form" domain-object-type="Organization" is-default="true">

        <default-value-setter component="temp.org.value.setter">
            <widget-states>
                <widgets ids="letter_priority,subject"/>
            </widget-states>
        </default-value-setter>

        <markup>
            <title>
                <new-object label-widget-id="titleNew"/>
                <existing-object label-widget-id="titleExisting"/>
            </title>
            <header>
                <table>
                    <tr>
                        <td width="100px" h-align="right">
                            <widget id="Name-Label"/>
                        </td>
                        <td width="100%" h-align="left">
                            <widget id="Name"/>
                        </td>
                        <td width="100%" h-align="left">
                            <widget id="backRef"/>
                        </td>
                        <td width="100%" h-align="left">
                            <widget id="backRefLabel"/>
                        </td>
                        <!-- text-box (Название) -->
                    </tr>
                    <tr>
                        <td width="100px" h-align="right">
                            <widget id="departmentsLabel"/>
                        </td>

                        <td width="100%" h-align="left">
                            <widget id="departmentsTableBro"/>
                        </td>
                        <!-- text-box (Название) -->
                    </tr>
                    <tr>
                        <td>
                            <widget id="cmfive1377"/>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <widget id="status_label"/>
                        </td>
                        <td>
                            <widget id="status"/>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <widget id="description_label"/>
                        </td>
                        <td>
                            <widget id="description"/>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <widget id="boss_label"/>
                        </td>
                        <td>
                            <widget id="boss"/>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <widget id="hyperlink"/>
                        </td>

                    </tr>
                    <tr>
                        <td>
                            <widget id="dep_table"/>
                        </td>
                    </tr>
                </table>

            </header>
            <body display-single-tab="false">
                <tab name="hierarchy">
                    <single-entry-group>
                        <tab-group>
                            <table>
                                <tr>
                                    <td>
                                        <widget id="hierarchy" width="1200px"/>

                                    </td>

                                </tr>
                            </table>
                        </tab-group>
                    </single-entry-group>
                </tab>
            </body>
        </markup>
        <widget-config>
            <label id="Name-Label">
                <field-path/>
                <relates-to widget-id="Name"/>
                <text>Название:</text>
            </label>
            <text-box id="Name">
                <field-path value="Name"/>
            </text-box>
            <label id="backRefLabel">

                <text>BackRef</text>
            </label>
            <linked-domain-object-hyperlink id="backRef">
                <field-path value="org_middle^organization"/>
                <linked-form name="org_middle_form"/>
                <pattern value="{org_middle|organization.name}"/>
            </linked-domain-object-hyperlink>
            <label id="departmentsLabel">

                <text>Departments:</text>
            </label>
            <linked-domain-object-hyperlink id="hyperlink"
                                            modal-window="false"> <!-- для единичного связанного объекта -->
                <field-path value="boss"/>
                <!-- для связанных объектов field-path обязательно должен ссылаться на поле типа reference -->
                <linked-form name="employee_form">
                </linked-form>
                <!-- форма, открывающаяся в модальном окне при нажатии на гиперссылку -->
                <pattern value="{name} {created_date}"/>
                <!-- в паттерне ссылки задаются относительно field-path -->
                <!-- <selection-filters row-limit="1"></selection-filters>-->


            </linked-domain-object-hyperlink>
            <date-box id="cmfive1377">
                <field-path value="created_date"/>
            </date-box>

            <table-browser id="departmentsTableBro" read-only="false">
                <field-path value="department^organization"/>
                <collection-ref name="Departments"/>

                <collection-view-ref name="departments_default_view"/>
                <selection-filters row-limit="100">

                </selection-filters>
                <!-- паттерн отображения уже выбранных значений -->
                <selection-pattern value="{name}"/>

                <input-text-filter name="byName"/>

                <!-- название фильтра по тексту, введённому пользователем -->
                <!--input-text-filter name="byNameforTableBrowser"/-->

                <!-- количество элементов, показываемых на одной странице выпадающего списка. в правом нижнем углу
                под таблицей указатель страниц (за пример нужно взять страницы поиска в Яндексе) -->
                <page-size>30</page-size>
                <display-chosen-values value="false"/>
                <selection-style name="inline"/>
                <single-choice value="false"/>
                <clear-all-button text="Очистить"/>
                <add-button image="..." text="Add"/>

                <!--default-sort-criteria column-field="created_date" order="desc" /-->
                <display-values-as-links value="true"/>
            </table-browser>
            <label id="titleExisting">
                <pattern value="date: {created_date}"/>
                <field-path value="created_date"/>
                <formatting>

                    <date-format pattern="dd.MM.yyyy HH:mm" style="short">

                        <field-paths>
                            <field-path value="created_date"/>
                        </field-paths>
                    </date-format>
                </formatting>
            </label>
            <label id="titleNew">
                <text>Создание Организации</text>
            </label>
            <label id="status_label">
                <text>Статус:</text>
            </label>
            <suggest-box id="status" read-only="true">
                <field-path value="status"/>

                <collection-ref name="Statuses"/>
                <selection-filters row-limit="1"></selection-filters>
                <!-- паттерн отображения значений выпадающего списка -->
                <drop-down-pattern value="{name}"/>

                <!-- паттерн отображения уже выбранных значений -->
                <selection-pattern value="{name}"/>

                <!-- название фильтра по тексту, введённому пользователем -->
                <input-text-filter name="byName"/>

                <!-- количество элементов, показываемых на одной странице выпадающего списка -->
                <page-size>10</page-size>
                <display-values-as-links value="false"/>
                <!--name может принимать 2 значения inline (стиль Студии Лебедева) и table (текущая реализация).
                    Если тэг отсутствует, то используется "inline"-вариант. -->
                <selection-style name="inline"/>
                <single-choice value="false"/>
                <clear-all-button text="Очистить"/>
                <default-sort-criteria column-field="name" order="asc"/>
                <selection-sort-criteria>
                    <sort-criterion field="name" order="asc"/>
                </selection-sort-criteria>

            </suggest-box>
            <label id="description_label">
                <text>Описание:</text>
            </label>
            <text-box id="description">
                <field-path value="description"/>
            </text-box>
            <label id="boss_label">
                <text>Начальник:</text>
            </label>
            <suggest-box id="boss">
                <field-path value="boss"/>

                <collection-ref name="Employees"/>
                <selection-filters row-limit="1"></selection-filters>
                <!-- паттерн отображения значений выпадающего списка -->
                <drop-down-pattern value="{name}"/>

                <!-- паттерн отображения уже выбранных значений -->
                <selection-pattern value="{name}"/>

                <!-- название фильтра по тексту, введённому пользователем -->
                <input-text-filter name="byName"/>

                <!-- количество элементов, показываемых на одной странице выпадающего списка -->
                <page-size>10</page-size>
                <display-values-as-links value="false"/>
                <!--name может принимать 2 значения inline (стиль Студии Лебедева) и table (текущая реализация).
                    Если тэг отсутствует, то используется "inline"-вариант. -->
                <selection-style name="inline"/>
                <single-choice value="false"/>
                <clear-all-button text="Очистить"/>
                <default-sort-criteria column-field="name" order="asc"/>
                <selection-sort-criteria>
                    <sort-criterion field="name" order="asc"/>
                </selection-sort-criteria>

            </suggest-box>
            <hierarchy-browser id="hierarchy">
                <field-path
                        value="department^organization"/>

                <!-- Определение списка/таблицы, выпадающего при раскрытии узла -->
                <!-- Уже выбранные элементы показываются помеченными галочками -->
                <!-- collection - название коллекции для отображения списка значений узла -->


                <!--<selection-filters row-limit="1"></selection-filters>-->
                <node-collection-def collection="departments" parent-filter="byOrganization"
                                     title="Департамент" display-create-button="true">
                    <single-choice value="false"/>

                    <linked-form-mapping>
                        <linked-form name="department_form" domain-object-type="department">
                            <title>
                                <existing-object>
                                    <pattern value="{id}, {created_date}"/>
                                    <formatting>
                                        <date-format pattern="dd-mm-yyyy HH-mm-ss" style="short">
                                            <time-zone id="Europe/Kiev"/>
                                            <field-paths>
                                                <field-path value="created_date"/>
                                            </field-paths>
                                        </date-format>
                                    </formatting>
                                </existing-object>
                                <new-object>
                                    <pattern value="new form "/>

                                </new-object>
                            </title>

                        </linked-form>
                    </linked-form-mapping>
                    <create-new-button text="Department" image="images/icons/arrow-down.png"/>

                    <display-values-as-links value="false"/>
                    <input-text-filter name="byName"/>
                    <!-- паттерн отображения уже выбранных значений -->
                    <selection-pattern value="{name}"/>
                    <!-- путь к узлу верхнего уровня (относительно пути этого узла) от узла данного уровня -->

                </node-collection-def>

                <!-- количество элементов, показываемых в данном узле дерева изначально -->
                <page-size>10</page-size>
                <single-choice value="true"/>
                <clear-all-button text="Очистить"/>
                <add-button image="..." text="Добавить"/>
                <display-values-as-links value="true"/>

            </hierarchy-browser>
            <linked-domain-objects-table id="dep_table">
                <field-path
                        value="department^organization"/>
                <linked-form name="organization_form" inline="true"/>
                <linked-form-mapping>
                    <linked-form name="department_form" domain-object-type="Department"/>
                </linked-form-mapping>
                <created-objects>
                    <created-object text="Отдел" domain-object-type="Department"/>
                </created-objects>

                <summary-table>
                    <summary-table-column header="Название" widget-id="Name">
                        <action component-name="default.linked.table.action"
                                access-checker="attachment.read.access.checker"
                                new-objects-access-checker="attachment.write.access.checker"
                                tooltip="Скачать">
                            <display position="before" tooltip="Скачать">
                                <image url="/images/icons/ico-save.gif"/>
                                <text value="Скачать"/>
                            </display>
                        </action>

                        <pattern value="{name} - Department">
                            <domain-object-types>
                                <domain-object-type name="Department"/>
                            </domain-object-types>
                        </pattern>
                        <pattern value="{name}"/>
                        <!-- пути задаются относительно базового field-path (correspondent) -->

                    </summary-table-column>

                </summary-table>
                <collection-ref name="Departments"/>

            </linked-domain-objects-table>
        </widget-config>
    </form>

    <form-mappings name="letter_mappings">
        <form-mapping domain-object-type="letter" form="letter_form">
            <field-path value="subject">
                <default-value>
                    <field value="Тема по умолчанию (из form-mapping)"/>
                </default-value>
            </field-path>
            <field-path value="actual_end_period">
                <default-value>
                    <field set-current-moment="true"/>
                </default-value>
            </field-path>
            <field-path value="letter_creator^letter.employee">
                <default-values>
                    <default-value>
                        <field>
                            <unique-key-value type="Employee">
                                <field name="Phone" value="8 (495) 777-55-01"/>
                            </unique-key-value>
                        </field>
                    </default-value>
                    <default-value>
                        <field>
                            <unique-key-value type="Employee">
                                <field name="Phone" value="8 (495) 777-55-04"/>
                            </unique-key-value>
                        </field>
                    </default-value>
                </default-values>
            </field-path>
            <users>
                <user uid="person2"/>
                <user uid="person7"/>
            </users>
            <groups>
                <group name="EmployeeBosses"/>
                <group name="test-group-2" priority="2"/>
            </groups>
        </form-mapping>
    </form-mappings>

    <collection-view name="org_middle_default_view" collection="org_middle_collection" is-default="true">
        <display>
            <column field="name" name="name" editable="false" type="string" sortable="true"/>

        </display>
    </collection-view>

    <collection-view name="letters_default_view" collection="Letters" is-default="true">
        <display>
            <column field="id" name="id" type="integer" sortable="false"/>
            <column field="subject" name="Тема" editable="false" type="string" sortable="true"/>
            <column field="created_date" name="Дата" editable="false" type="string" sortable="true"/>
            <column field="actual_start_period" name="Актуально с" editable="false" type="datetime" sortable="true"/>
            <column field="actual_end_period" name="Актуально по" editable="false" type="datetime" sortable="true"/>
        </display>
    </collection-view>
    <collection name="org_middle_collection" idField="id">
        <prototype>
            <![CDATA[
                    select
                        om.id, om.name, om.organization
                    from
                        org_middle om  where
                    1=1 ::where-clause
                ]]>
        </prototype>

        <counting-prototype>
            select count(*) from org_middle om
        </counting-prototype>
        <filter name="byText">
            <criteria placeholder="where-clause">
                <![CDATA[
                    om.name like {0}
                ]]>
            </criteria>
        </filter>
        <filter name="byId">
            <criteria placeholder="where-clause">
                <![CDATA[
                    om.organization = {0}
                ]]>
            </criteria>
        </filter>
    </collection>
    <collection name="employeesWithOrganization" idField="id">
        <prototype>
            <![CDATA[
                    select
                        em.id, em.name, em.position
                    from
                        employee em  where
                    em.organization IS NOT NULL ::where-clause
                ]]>
        </prototype>

        <counting-prototype>
            select count(*) from org_middle om
        </counting-prototype>
        <filter name="byText">
            <criteria placeholder="where-clause">
                <![CDATA[
                    lower(em.name) like lower('%'||{0}) OR lower(em.position) like lower('%'||{0})
                ]]>
            </criteria>
        </filter>
        <filter name="byOrganization">
            <criteria placeholder="where-clause">
                <![CDATA[
                    em.organization = {0}
                ]]>
            </criteria>
        </filter>
    </collection>
    <form-mappings name="org_middle_mappings">
        <form-mapping domain-object-type="org_middle" form="org_middle_form">
            <users>
                <user uid="admin"/>
            </users>
            <groups>
                <group name="Minister"/>
            </groups>
        </form-mapping>
    </form-mappings>
    <collection name="letters" idField="id">
        <prototype>
            <![CDATA[
                    select
                        l.id, l.subject, l.created_date, l.actual_start_period, l.actual_end_period
                    from
                        letter l
                ]]>
        </prototype>

        <counting-prototype>
            select count(*) from letter l
        </counting-prototype>
    </collection>

    <form name="developer_form1" domain-object-type="Developer" is-default="true">
        <markup>
            <header>
                <table>
                    <tr>
                        <td width="100px" h-align="right">
                            <widget id="Name-Label"/>
                        </td>
                        <td width="100%" h-align="left">
                            <widget id="Name"/>
                        </td>
                        <!-- text-box (Название) -->
                    </tr>
                </table>
            </header>
            <body display-single-tab="false"> <!-- в теле - только закладки -->
                <tab name="Главная"> <!-- закладка состоит из групп с разметкой -->
                    <single-entry-group> <!-- наследник от TabGroupsConfig -->
                        <tab-group> <!-- вхождение в группу уже может содержать разметку -->
                            <table>
                                <tr>
                                    <td h-align="right">
                                        <widget id="Department-Label"/>
                                    </td>
                                    <td h-align="left">
                                        <widget id="Department"/>
                                    </td>
                                </tr>
                                <tr>
                                    <td h-align="right">
                                        <widget id="positionLabel"/>
                                    </td>
                                    <td h-align="left">
                                        <widget id="position"/>
                                    </td>

                                    <td h-align="left">
                                        <widget id="hyperlink"/>
                                    </td>
                                    <td h-align="left">
                                        <widget id="language"/>
                                    </td>

                                </tr>
                            </table>
                        </tab-group>
                    </single-entry-group>
                </tab>
            </body>
        </markup>
        <widget-config>
            <label id="Name-Label">
                <field-path/>
                <relates-to widget-id="Name"/>
                <text>Название:</text>
            </label>
            <text-box id="Name">
                <field-path value="Name"/>
            </text-box>

            <label id="Department-Label">
                <relates-to widget-id="Department"/>
                <text>Департамент:</text>
            </label>
            <combo-box id="Department">
                <field-path value="Department"/>
                <pattern value="{Name}"/>
            </combo-box>

            <label id="positionLabel">
                <relates-to widget-id="position"/>
                <text>Должность:</text>
            </label>
            <text-box id="position">
                <field-path value="Position"/>
            </text-box>
            <linked-domain-object-hyperlink id="hyperlink"> <!-- для единичного связанного объекта -->
                <field-path value="department"/>
                <!-- для связанных объектов field-path обязательно должен ссылаться на поле типа reference -->
                <linked-form name="department_form">
                    <title>
                        <existing-object>
                            <pattern value="{id}, {created_date}"/>
                            <formatting>
                                <date-format pattern="dd-mm-yyyy HH-mm-ss" style="short">
                                    <time-zone id="Europe/Kiev"/>
                                    <field-paths>
                                        <field-path value="created_date"/>
                                    </field-paths>
                                </date-format>
                            </formatting>
                        </existing-object>
                        <new-object>
                            <pattern value="new form "/>

                        </new-object>
                    </title>
                </linked-form>
                <!-- форма, открывающаяся в модальном окне при нажатии на гиперссылку -->
                <pattern value="{name} {created_date}"/>
                <!-- в паттерне ссылки задаются относительно field-path -->
                <formatting>

                    <date-format pattern="dd-mm-yyyy HH:mm:ss" style="short">
                        <time-zone id="Europe/Kiev"/>
                        <field-paths>
                            <field-path value="created_date"/>
                        </field-paths>
                    </date-format>
                </formatting>
            </linked-domain-object-hyperlink>

            <enumeration-box id="language">
                <field-path value="language"/>
                <mapping>
                    <map value="Java" display-text="Java"/>
                    <map value="C++" display-text="C++"/>
                    <map value=".Net" display-text=".Net"/>
                </mapping>
            </enumeration-box>
        </widget-config>
    </form>
    <form name="developer_form2" domain-object-type="Developer" is-default="false">
        <markup>
            <header>
                <table>
                    <tr>
                        <td width="100px" h-align="right">
                            <widget id="Name-Label"/>
                        </td>
                        <td width="100%" h-align="left">
                            <widget id="Name"/>
                        </td>
                        <!-- text-box (Название) -->
                    </tr>
                </table>
            </header>
            <body display-single-tab="false"> <!-- в теле - только закладки -->
                <tab name="Главная"> <!-- закладка состоит из групп с разметкой -->
                    <single-entry-group> <!-- наследник от TabGroupsConfig -->
                        <tab-group> <!-- вхождение в группу уже может содержать разметку -->
                            <table>
                                <tr>
                                    <td h-align="right">
                                        <widget id="Department-Label"/>
                                    </td>
                                    <td h-align="left">
                                        <widget id="Department"/>
                                    </td>
                                </tr>
                                <tr>
                                    <td h-align="right">
                                        <widget id="positionLabel"/>
                                    </td>
                                    <td h-align="left">
                                        <widget id="position"/>
                                    </td>

                                    <td h-align="left">
                                        <widget id="hyperlink"/>
                                    </td>
                                    <td h-align="left">
                                        <widget id="lang"/>
                                    </td>

                                </tr>
                            </table>
                        </tab-group>
                    </single-entry-group>
                </tab>
            </body>
        </markup>
        <widget-config>
            <label id="Name-Label">
                <field-path/>
                <relates-to widget-id="Name"/>
                <text>Название:</text>
            </label>
            <text-box id="Name">
                <field-path value="Name"/>
            </text-box>

            <label id="Department-Label">
                <relates-to widget-id="Department"/>
                <text>Департамент:</text>
            </label>
            <combo-box id="Department">
                <field-path value="Department"/>
                <pattern value="{Name}"/>
            </combo-box>

            <label id="positionLabel">
                <relates-to widget-id="position"/>
                <text>Должность:</text>
            </label>
            <text-box id="position">
                <field-path value="Position"/>
            </text-box>
            <linked-domain-object-hyperlink id="hyperlink"> <!-- для единичного связанного объекта -->
                <field-path value="department"/>
                <!-- для связанных объектов field-path обязательно должен ссылаться на поле типа reference -->
                <linked-form name="department_form">
                    <title>
                        <existing-object>
                            <pattern value="{id}, {created_date}"/>
                            <formatting>
                                <date-format pattern="dd-mm-yyyy HH-mm-ss" style="short">
                                    <time-zone id="Europe/Kiev"/>
                                    <field-paths>
                                        <field-path value="created_date"/>
                                    </field-paths>
                                </date-format>
                            </formatting>
                        </existing-object>
                        <new-object>
                            <pattern value="new form "/>

                        </new-object>
                    </title>
                </linked-form>
                <!-- форма, открывающаяся в модальном окне при нажатии на гиперссылку -->
                <pattern value="{name} {created_date}"/>
                <!-- в паттерне ссылки задаются относительно field-path -->
                <formatting>

                    <date-format pattern="dd-mm-yyyy HH:mm:ss" style="short">
                        <time-zone id="Europe/Kiev"/>
                        <field-paths>
                            <field-path value="created_date"/>
                        </field-paths>
                    </date-format>
                </formatting>
            </linked-domain-object-hyperlink>

            <enumeration-box id="lang">
                <field-path value="language"/>
                <mapping>
                    <map value="Java" display-text="Java"/>
                    <map value="C++" display-text="C++"/>
                    <map value=".Net" display-text=".Net"/>
                </mapping>
            </enumeration-box>
        </widget-config>
    </form>
    <form-mappings name="developer_mappings">
        <form-mapping domain-object-type="Developer" form="developer_form1"/>
        <form-mapping domain-object-type="Developer" form="developer_form2"/>

    </form-mappings>
    <collection name="Statuses" idField="id">
        <prototype>
            <![CDATA[
                    select
                       s.id, s.name
                    from
                        Status s

                        where
                    1 = 1 ::where-clause
                ]]>
        </prototype>
        <counting-prototype>
            select count(*) from Organization o
        </counting-prototype>
        <filter name="byName">
            <criteria placeholder="where-clause">
                <![CDATA[
                    s.name like {0}
                ]]>
            </criteria>
        </filter>

    </collection>

</configuration>