<configuration>
<form name="country_form" domain-object-type="country" is-default="true" debug = "false">
    <markup>
        <body display-single-tab="false">
            <tab name="Главная">
                <single-entry-group>
                    <tab-group>
                        <table>
                            <tr>
                                <td h-align="center" v-align="center">
                                    <widget id="1"/>
                                </td>
                                <!-- label (Население) -->
                                <td h-align="left">
                                    <widget id="4"/>
                                </td>
                            </tr>
                        </table>
                    </tab-group>
                </single-entry-group>
            </tab>
        </body>
    </markup>
    <widget-config>
        <!-- Если выбор единственный (см. CMFIVE-229), то чек-боксы показывать не надо и выбор в данном случае можно
        сделать как по кнопке "Ок", так и двойным щелчком -->
        <table-browser id="1">
            <field-path value="some_reference"/>

            <pattern value="{name} ({population} чел.)"/>

            <collection-ref name="Cities"/>

            <collection-view-ref name="Cities-default-view"/>

            <!-- название фильтра, использующегося при получении описания уже выбранных значений -->
            <selection-filter name="idsIncluded"/>

            <!-- название фильтра, отсекающего, уже выбранные значения (для того, чтобы они не показывались в списке -->
            <selection-exclude-filter name="idsExcluded"/>

            <!-- паттерн отображения уже выбранных значений -->
            <selection-pattern value="{name} {population} {year_of_foundation}"/>

            <!-- название фильтра по тексту, введённому пользователем -->
            <input-text-filter name="byText"/>

            <!-- количество элементов, показываемых на одной странице выпадающего списка. в правом нижнем углу
            под таблицей указатель страниц (за пример нужно взять страницы поиска в Яндексе) -->
            <page-size>30</page-size>
        </table-browser>

        <!-- возможный упрощённый вариант, который сейчас реализовать невозможно -->
        <hierarchy-browser id="2">
            <field-path value="organization_addressee^letter.organization, department_addressee^letter.department, employee_addressee^letter.employee"/>

            <!-- Определение списка/таблицы, выпадающего при раскрытии узла -->
            <!-- Уже выбранные элементы показываются помеченными галочками -->
            <node-def domain-object-type="organization">
                <!-- название фильтра по тексту, введённому пользователем -->
                <input-text-filter name="byName"/>
                <!-- паттерн отображения уже выбранных значений -->
                <selection-pattern value="{name}"/>
                <node-def domain-object-type="department" parent-link-field="organization">
                    <!-- название фильтра по тексту, введённому пользователем -->
                    <input-text-filter name="byName"/>
                    <!-- паттерн отображения уже выбранных значений -->
                    <selection-pattern value="{name}"/>
                    <node-def domain-object-type="employee" parent-link-field="department">
                        <!-- название фильтра по тексту, введённому пользователем -->
                        <input-text-filter name="byLastNameAndName"/>
                        <!-- паттерн отображения уже выбранных значений -->
                        <selection-pattern value="{name} {last_name}"/>
                    </node-def>
                </node-def>
            </node-def>

            <!-- количество элементов, показываемых в данном узле дерева изначально -->
            <page-size>30</page-size>
        </hierarchy-browser>

        <!-- актуальный вариант, вынуждающий нас конфигурировать коллекции для каждого типа узла -->
        <hierarchy-browser id="2">
            <field-path value="organization_addressee^letter.organization, department_addressee^letter.department, employee_addressee^letter.employee"/>

            <!-- Определение списка/таблицы, выпадающего при раскрытии узла -->
            <!-- Уже выбранные элементы показываются помеченными галочками -->
            <!-- collection - название коллекции для отображения списка значений узла -->
            <node-def collection="Organizations">
                <!-- название фильтра по тексту, введённому пользователем -->
                <input-text-filter name="byName"/>
                <!-- паттерн отображения уже выбранных значений -->
                <selection-pattern value="{name}"/>
                <node-collection-def collection="Departments" parent-filter="byOrganization">
                    <!-- название фильтра по тексту, введённому пользователем -->
                    <input-text-filter name="byName"/>
                    <!-- паттерн отображения уже выбранных значений -->
                    <selection-pattern value="{name}"/>
                        <!-- путь к узлу верхнего уровня (относительно пути этого узла) от узла данного уровня -->
                    <node-collection-def collection="Employees" parent-filter="byDepartment">
                        <!-- название фильтра по тексту, введённому пользователем -->
                        <input-text-filter name="byLastNameAndName"/>
                        <!-- паттерн отображения уже выбранных значений -->
                        <selection-pattern value="{name} {last_name}"/>
                    </node-collection-def>
                </node-collection-def>
            </node-def>

            <!-- количество элементов, показываемых в данном узле дерева изначально -->
            <page-size>30</page-size>
        </hierarchy-browser>
    </widget-config>
</form>
</configuration>